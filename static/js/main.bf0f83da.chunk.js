(this.webpackJsonpweb=this.webpackJsonpweb||[]).push([[0],{45:function(e,t,n){},46:function(e,t,n){"use strict";n.r(t);var r,a,s,c=n(0),o=n(27),l=n.n(o),i=n(21),u=n(7);function d(e){!function(e,t,n){var r=new Date;r.setTime(r.getTime()+864e5*n),document.cookie=e+"="+t+";path=/;expires="+r.toUTCString()}(e,"",-1)}var b=new(n(30).a)({twitchClientId:null!==(r="il5oqz0li81219qvw2hs7umntr493e")?r:"",apiBaseUrl:null!==(a="https://spamchamp-api.gempir.com")?a:"",baseUrl:null!==(s="https://spamchamp.gempir.com")?s:"",scToken:function(e){var t=document.cookie.match("(^|;) ?"+e+"=([^;]*)(;|$)");return t?t[2]:null}("scToken"),managing:""}),j=n(1);function m(){var e=b.useState((function(e){return e.scToken})),t=Object(j.jsx)(p,{className:"p-4 rounded shadow bg-purple-800 hover:bg-purple-600"});return e&&(t=Object(j.jsx)(h,{})),Object(j.jsx)("div",{className:"m-4 flex flex-row justify-end gap-4",children:t})}function h(){return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(i.b,{to:"/",className:"p-4 rounded shadow bg-gray-800 hover:bg-gray-700",children:"Home"}),Object(j.jsx)(i.b,{to:"/dashboard",className:"p-4 rounded shadow bg-blue-900 hover:bg-blue-800",children:"Dashboard"}),Object(j.jsx)(p,{className:"p-4 rounded shadow opacity-25 bg-purple-800 hover:bg-purple-600"})]})}function p(e){var t=e.className,n=b.getRawState(),r=n.apiBaseUrl,a=n.twitchClientId,s=new URL("https://id.twitch.tv/oauth2/authorize");return s.searchParams.set("client_id",a),s.searchParams.set("redirect_uri",r+"/api/callback"),s.searchParams.set("response_type","code"),s.searchParams.set("scope","channel:read:redemptions channel:manage:redemptions"),Object(j.jsx)("a",{className:t,href:s.toString(),children:"Login"})}var f,g=n(2),O=n(48),x=n(4),v=n.n(x),w=n(3),N=n(9);function C(e,t){return y.apply(this,arguments)}function y(){return(y=Object(N.a)(v.a.mark((function e(t,n){var r,a,s,c,o,l,i=arguments;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>2&&void 0!==i[2]?i[2]:void 0,a=b.getRawState(),s=a.apiBaseUrl,c=a.scToken,o={"content-type":"application/json"},c&&(o.Authorization="Bearer ".concat(c)),l={method:t,headers:Object(w.a)({},o)},r&&(l.body=JSON.stringify(r)),e.abrupt("return",window.fetch("".concat(s).concat(n),l).then(function(){var e=Object(N.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(401!==t.status){e.next=4;break}return d("scToken"),window.location.assign("/"),e.abrupt("return");case 4:if(!t.ok){e.next=10;break}return e.next=7,t.json();case 7:return e.abrupt("return",e.sent);case 10:return e.next=12,t.text();case 12:return n=e.sent,e.abrupt("return",Promise.reject(new Error(n)));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(e){e.GET="GET",e.POST="POST",e.DELETE="POST"}(f||(f={}));var k=n(5);function S(e){var t=e.userConfig;if(0===(null===t||void 0===t?void 0:t.Protected.EditorFor.length))return null;var n=b.useState((function(e){return e.managing}));return Object(j.jsx)("div",{className:"Managing",children:Object(j.jsxs)("select",{className:"bg-gray-800 shadow rounded p-3",onChange:function(e){return b.update((function(t){t.managing=e.target.value}))},value:n,children:[null===t||void 0===t?void 0:t.Protected.EditorFor.map((function(e){return Object(j.jsx)("option",{value:e,children:e},e)})),Object(j.jsx)("option",{value:"",children:"you"})]})})}function P(e){var t=e.setUserConfig;return""!==b.useState((function(e){return e.managing}))?null:Object(j.jsx)("div",{className:"p-3 opacity-25 hover:opacity-100 bg-red-900 hover:bg-red-800 shadow rounded cursor-pointer",onClick:function(){window.confirm("Do you really want to reset?\n- Channel Point Rewards on Twitch from spamchamp\n- Settings on spamchamp.gempir.com\n- Unsubscribes all webhooks for your channel")&&t(null)},children:"Reset"})}function T(e){var t=e.userConfig,n=e.setUserConfig;return Object(j.jsxs)("div",{className:"flex flex-row flex-wrap gap-4 ml-4",children:[Object(j.jsx)(S,{userConfig:t}),Object(j.jsx)(P,{setUserConfig:n}),Object(j.jsx)(B,{setUserConfig:n,userConfig:t})]})}function B(e){var t=e.setUserConfig,n=e.userConfig,r=b.useState((function(e){return e.managing})),a={};null===n||void 0===n||n.Editors.map((function(e){return a["e"+(Object.values(a).length+1)]=e,e}));var s,o=Object(c.useState)(a),l=Object(g.a)(o,2),i=l[0],u=l[1],d=function(e,r){var a=Object(w.a)({},i);null===r?(delete a[e],u(a)):(a[e]=r,u(a)),t(Object(w.a)(Object(w.a)({},n),{},{Editors:Object.values(a)}))},m=[],h=Object(k.a)(Object.entries(i).sort());try{for(h.s();!(s=h.n()).done;){var p=Object(g.a)(s.value,2),f=p[0],O=p[1];m.push(Object(j.jsx)(E,{editor:O,id:f,onChange:d},f))}}catch(v){h.e(v)}finally{h.f()}var x=0===Object.values(i).filter((function(e){return 0===e.length})).length;return""!==r?null:Object(j.jsxs)(j.Fragment,{children:[m,x&&Object(j.jsx)("div",{className:"bg-green-700 rounded shadow p-3 cursor-pointer hover:bg-green-600",onClick:function(){var e=Object(w.a)({},i);e["e"+(Object.values(i).length+1)]="",u(e)},children:"add editor"})]})}function E(e){var t=e.id,n=e.editor,r=e.onChange,a=Object(c.useState)(n),s=Object(g.a)(a,2),o=s[0],l=s[1],i=Object(c.useRef)(null);return Object(j.jsxs)("div",{className:"flex items-center",children:[Object(j.jsx)("input",{className:"bg-blue-900 hover:bg-blue-800 focus:bg-blue:800 p-3 rounded shadow w-24 rounded-r-none truncate",spellCheck:!1,ref:i,type:"text",value:o,onKeyDown:function(e){return function(e){13===e.keyCode&&null!==i.current&&i.current.blur()}(e)},onChange:function(e){return l(e.target.value)},onBlur:function(){return r(t,o)}},n),Object(j.jsx)("span",{className:"bg-red-900 p-3 px-1 font-bold opacity-25 hover:opacity-100 cursor-pointer rounded rounded-l-none",onClick:function(){return r(t,null)},children:"X"})]})}var U=n(29);function R(e){var t,n,r,a,s,c,o,l,i,u,d=e.userConfig,b=e.setUserConfig,m=Object(U.a)(),h=m.register,p=m.handleSubmit,f=m.formState.errors;return Object(j.jsxs)("form",{onSubmit:p((function(e){return b(Object(w.a)(Object(w.a)({},d),{},{Rewards:Object(w.a)(Object(w.a)({},null===d||void 0===d?void 0:d.Rewards),{},{Bttv:Object(w.a)(Object(w.a)({},e),{},{isDefault:!1,cost:Number(e.cost),maxPerStream:Number(e.maxPerStream),maxPerUserPerStream:Number(e.maxPerUserPerStream),globalCooldownSeconds:60*Number(e.globalCooldownMinutes)})})}))})),className:"max-w-5xl m-4 p-4 bg-gray-800 rounded shadow",children:[Object(j.jsxs)("div",{className:"flex items-center justify-between",children:[Object(j.jsxs)("div",{className:"flex items-center gap-5",children:[Object(j.jsx)("img",{src:"/images/bttv.png",alt:"Bttv Emote Reward",className:"w-16"}),Object(j.jsx)("h3",{className:"text-xl font-bold",children:"BetterTTV Emote"})]}),Object(j.jsx)("div",{className:"text-gray-600",children:null===(t=d.Rewards.Bttv)||void 0===t?void 0:t.ID})]}),Object(j.jsxs)("p",{className:"my-2 mb-4 text-gray-400",children:[Object(j.jsxs)("strong",{children:["Make sure ",Object(j.jsx)("span",{className:"text-green-600",children:"gempbot"})," is BetterTTV editor"]}),Object(j.jsx)("br",{}),"This will swap out 1 emote constantly. If the previous emote is not found it will use a free slot or remove a random emote."]}),Object(j.jsxs)("label",{className:"block",children:["Title",Object(j.jsx)("input",Object(w.a)(Object(w.a)({defaultValue:null===(n=d.Rewards.Bttv)||void 0===n?void 0:n.title,spellCheck:!1},h("title",{required:!0})),{},{className:"form-input border-none bg-gray-700 mx-2 p-2 rounded shadow"})),f.title&&Object(j.jsx)("span",{className:"text-red-700",children:"required"})]}),Object(j.jsxs)("label",{className:"block mt-3",children:["Cost",Object(j.jsx)("input",Object(w.a)(Object(w.a)({defaultValue:null===(r=d.Rewards.Bttv)||void 0===r?void 0:r.cost,type:"number",spellCheck:!1},h("cost",{required:!0})),{},{className:"form-input border-none bg-gray-700 mx-2 p-2 rounded shadow"})),f.cost&&Object(j.jsx)("span",{className:"text-red-700",children:"required"})]}),Object(j.jsxs)("label",{className:"block mt-3",children:["Prompt",Object(j.jsx)("input",Object(w.a)(Object(w.a)({defaultValue:null===(a=d.Rewards.Bttv)||void 0===a?void 0:a.prompt,spellCheck:!1,disabled:!0},h("prompt")),{},{className:"block cursor-not-allowed truncate form-input w-full opacity-25 border-none bg-gray-700 mt-2 p-2 rounded shadow"}))]}),Object(j.jsxs)("label",{className:"block mt-3",children:["Background Color",Object(j.jsx)("input",Object(w.a)(Object(w.a)({defaultValue:null===(s=d.Rewards.Bttv)||void 0===s?void 0:s.backgroundColor,placeholder:"#FFFFFF",spellCheck:!1},h("backgroundColor")),{},{className:"form-input border-none bg-gray-700 mx-2 p-2 rounded shadow"}))]}),Object(j.jsxs)("div",{className:"mt-8 font-bold",children:["Limits ",Object(j.jsx)("span",{className:"text-gray-500",children:"(0 = unlimited)"})]}),Object(j.jsxs)("label",{className:"flex items-center mt-3",children:["Max per Stream",Object(j.jsx)("input",Object(w.a)(Object(w.a)({defaultValue:null===(c=d.Rewards.Bttv)||void 0===c?void 0:c.maxPerStream,placeholder:"0",type:"number",spellCheck:!1},h("maxPerStream")),{},{className:"form-input border-none bg-gray-700 mx-2 p-2 rounded shadow"}))]}),Object(j.jsxs)("label",{className:"flex items-center mt-3",children:["Max per User per Stream",Object(j.jsx)("input",Object(w.a)(Object(w.a)({defaultValue:null===(o=d.Rewards.Bttv)||void 0===o?void 0:o.maxPerUserPerStream,placeholder:"0",type:"number",spellCheck:!1},h("maxPerUserPerStream")),{},{className:"form-input border-none bg-gray-700 mx-2 p-2 rounded shadow"}))]}),Object(j.jsxs)("label",{className:"flex items-center mt-3",children:["Global Cooldown in Minutes",Object(j.jsx)("input",Object(w.a)(Object(w.a)({defaultValue:(null!==(l=null===(i=d.Rewards.Bttv)||void 0===i?void 0:i.globalCooldownSeconds)&&void 0!==l?l:0)/60,placeholder:"0",type:"number",spellCheck:!1},h("globalCooldownMinutes")),{},{className:"form-input border-none bg-gray-700 mx-2 p-2 rounded shadow"}))]}),Object(j.jsxs)("div",{className:"flex flex-row justify-between items-center select-none",children:[Object(j.jsxs)("label",{className:"flex items-center",children:[Object(j.jsx)("input",Object(w.a)(Object(w.a)({defaultChecked:null===(u=d.Rewards.Bttv)||void 0===u?void 0:u.enabled,type:"checkbox"},h("enabled")),{},{className:"form-checkbox rounded border-gray-300 text-indigo-600 shadow-sm focus:border-indigo-300 focus:ring focus:ring-offset-0 focus:ring-indigo-200 focus:ring-opacity-50"})),Object(j.jsx)("span",{className:"ml-2",children:"Enabled"})]}),Object(j.jsx)("input",{type:"submit",className:"bg-green-700 hover:bg-green-600 p-2 rounded shadow block mt-3",value:"save"})]})]})}function F(){var e=Object(c.useState)(1),t=Object(g.a)(e,2),n=t[0],r=t[1],a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=Object(c.useState)(void 0),a=Object(g.a)(r,2),s=a[0],o=a[1],l=Object(c.useState)(0),i=Object(g.a)(l,2),u=i[0],d=i[1],j=b.useState((function(e){return e.managing})),m=function(){var e="/api/userConfig";j&&(e+="?managing=".concat(j)),C(f.GET,e).then((function(e){return o(e)})).catch(t)};return Object(c.useEffect)(m,[j]),Object(c.useEffect)(n,[s]),Object(O.a)((function(){if(u&&s){var n="/api/userConfig";j&&(n+="?managing=".concat(j)),C(f.POST,n,s).then((function(t){o(t),e()})).catch(t)}else u&&null===s&&C(f.DELETE,"/api/userConfig").then(m).catch(t)}),500,[u]),[s,function(e){o(e),d(u+1)}]}(void 0,void 0,(function(){return r(n+1)})),s=Object(g.a)(a,2),o=s[0],l=s[1];return o?Object(j.jsxs)("div",{children:[Object(j.jsx)(T,{userConfig:o,setUserConfig:l}),Object(j.jsx)(R,{userConfig:o,setUserConfig:l})]},n):null}var V=n(13),D=function e(t){Object(V.a)(this,e);var n=b.getRawState().apiBaseUrl;!function e(){var r=new WebSocket("".concat(n.replace("https://","wss://").replace("http://","ws://"),"/api/ws"));r.onmessage=function(e){t(JSON.parse(e.data))},r.onclose=function(t){console.log("Socket is closed. Reconnect will be attempted in 1 second.",t.reason),setTimeout(e,1e3)},r.onerror=function(e){console.error("Socket encountered error: ",e,"Closing socket"),r.close()}}()};function M(e){var t=e.activeChannels,n=e.joinedChannels;return Object(j.jsxs)("div",{className:"flex flex-row",children:[Object(j.jsxs)("div",{className:"rounded shadow bg-gray-800 p-4 w-64 m-4",children:["Joined Channels: ",Object(j.jsx)("strong",{children:n})]}),Object(j.jsxs)("div",{className:"rounded shadow bg-gray-800 p-4 w-64 m-4 -ml-0",children:["Active Channels: ",Object(j.jsx)("strong",{children:t})]})]})}function q(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{src:"https://static-cdn.jtvnw.net/user-default-pictures-uv/cdd517fe-def4-11e9-948e-784f43822e80-profile_image-70x70.png"},t=e.src;return Object(j.jsx)("img",{src:t,width:"30",height:"30",alt:"profile"})}function I(e){var t=e.records;return Object(j.jsx)("div",{className:"flex flex-row pl-4",children:t.map((function(e){return Object(j.jsx)(J,{record:e},e.title)}))})}function J(e){var t=e.record;return Object(j.jsxs)("div",{className:"bg-gray-800 rounded shadow p-4 w-64 mr-4 ml-0",children:[Object(j.jsx)("h2",{className:"text-1xl font-bold",children:t.title}),Object(j.jsx)("ol",{children:t.scores.map((function(e){return Object(j.jsxs)("li",{className:"flex flex-row justify-between items-center m-1",children:[Object(j.jsx)(q,{src:e.user.profilePicture}),Object(j.jsx)("span",{className:"font-bold",children:e.user.displayName}),Object(j.jsx)("span",{className:"font-bold",children:e.score})]},e.user.id)}))})]})}function L(){var e=Object(c.useState)(0),t=Object(g.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(0),s=Object(g.a)(a,2),o=s[0],l=s[1],i=Object(c.useState)([]),u=Object(g.a)(i,2),d=u[0],b=u[1];return Object(c.useEffect)((function(){new D((function(e){r(e.joinedChannels),l(e.activeChannels),b(e.records)}))}),[]),Object(j.jsxs)("div",{children:[Object(j.jsx)(M,{activeChannels:o,joinedChannels:n}),Object(j.jsx)(I,{records:d})]})}function G(){return Object(j.jsxs)(i.a,{children:[Object(j.jsx)(m,{}),Object(j.jsxs)(u.c,{children:[Object(j.jsx)(u.a,{path:"/dashboard",children:Object(j.jsx)(F,{})}),Object(j.jsx)(u.a,{path:"/",children:Object(j.jsx)(L,{})})]})]})}n(45);l.a.render(Object(j.jsx)(c.StrictMode,{children:Object(j.jsx)(G,{})}),document.getElementById("root"))}},[[46,1,2]]]);
//# sourceMappingURL=main.bf0f83da.chunk.js.map