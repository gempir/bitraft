(this.webpackJsonpweb=this.webpackJsonpweb||[]).push([[0],{37:function(n,e,t){"use strict";t.r(e);var r=t(3),i=t(0),a=t.n(i),c=t(21),o=t.n(c),s=t(4),d=t(6),b=t(14),l=t(2);function h(n,e){403===e.status&&n(null)}function u(n){if(!n.ok)throw n;return n.json()}var g=t(15);function j(n,e,t){var r=new Date;r.setTime(r.getTime()+864e5*t),document.cookie=n+"="+e+";path=/;expires="+r.toUTCString()}var p=t(1),m={state:{apiBaseUrl:"https://spamchamp-api.gempir.com",twitchClientId:"il5oqz0li81219qvw2hs7umntr493e",baseUrl:"https://spamchamp.gempir.com",scToken:function(n){var e=document.cookie.match("(^|;) ?"+n+"=([^;]*)(;|$)");return e?e[2]:null}("scToken")},setState:function(n){},setScToken:function(n){}},x=Object(i.createContext)(m),f=x.Provider,v=function(n){var e=n.children,t=Object(i.useState)(Object(g.a)({},m.state)),r=Object(d.a)(t,2),a=r[0],c=r[1];return Object(p.jsx)(f,{value:{state:a,setState:c,setScToken:function(n){null===n?j("scToken","",-1):j("scToken",n,365),n!==a.scToken&&c(Object(g.a)(Object(g.a)({},a),{},{scToken:n}))}},children:e})};var O,k=t(39);var w,C,S=s.b.div(O||(O=Object(r.a)(["\n    position: absolute;\n    top: 1rem;\n    left: 1rem;\n    display: block;\n    color: white;\n    padding: 1rem 1rem;\n    text-decoration: none;\n    font-weight: bold;\n    border-radius: 3px;\n    background: var(--danger-dark);\n    cursor: pointer;\n\n    &:hover {\n        background: var(--danger);\n    }\n"])));function y(n){var e=n.setUserConfig;return Object(p.jsx)(S,{onClick:function(){window.confirm("Do you really want to reset?\n- Channel Point Rewards from spamchamp\n- Settings on spamchamp.gempir.com\n- Unsubscribes all webhooks for your channel")&&e(null)},children:"Reset"})}var T,B=s.b.div(w||(w=Object(r.a)(["\n    display: grid;\n    grid-gap: 1rem;\n"]))),N=s.b.div(C||(C=Object(r.a)(["\n    background: var(--bg-bright);\n    border: 1px solid var(--bg-brighter);\n    padding: 0.5rem;\n\n    .container {\n        display: grid;\n        grid-template-columns: 56px 1fr;\n        grid-gap: 1rem;\n    }\n"])));function U(n){var e=n.rewards;return Object(p.jsx)(B,{children:e.map((function(n){var e,t;return Object(p.jsx)(N,{children:Object(p.jsxs)("div",{className:"container",children:[Object(p.jsx)("img",{src:null!==(e=null===(t=n.image)||void 0===t?void 0:t.url_2x)&&void 0!==e?e:n.default_image.url_2x,alt:n.title}),Object(p.jsxs)("div",{children:[Object(p.jsx)("h5",{children:n.title}),Object(p.jsx)("p",{children:n.prompt})]})]})},n.id)}))})}function z(){var n=Object(i.useState)(["userConfig"]),e=Object(d.a)(n,2),t=e[0],r=e[1],a=function(n){var e=Object(i.useContext)(x).state,t=e.scToken,r=e.apiBaseUrl,a=Object(i.useContext)(x).setScToken,c=Object(i.useState)(void 0),o=Object(d.a)(c,2),s=o[0],b=o[1],l=Object(i.useState)(0),g=Object(d.a)(l,2),j=g[0],p=g[1],m=function(){t&&fetch(r+"/api/userConfig",{headers:{Authorization:"Bearer "+t}}).then(u).then((function(n){return b(n)})).catch((function(n){return h(a,n)}))};return Object(i.useEffect)(m,[t,r,a]),Object(k.a)((function(){j&&s&&t?fetch(r+"/api/userConfig",{headers:{Authorization:"Bearer "+t},method:"POST",body:JSON.stringify(s)}).then(u).then(n).catch((function(n){return h(a,n)})):j&&null===s&&t&&fetch(r+"/api/userConfig",{headers:{Authorization:"Bearer "+t},method:"DELETE"}).then(u).then(m).catch((function(n){return h(a,n)}))}),500,[j]),[s,function(n){b(n),p(j+1)}]}((function(){var n=t.slice();n.push("saved"),r(n),setTimeout((function(){r(["userConfig"])}),500)})),c=Object(d.a)(a,2),o=c[0],s=c[1],b=function(){var n=Object(i.useContext)(x).state,e=n.scToken,t=n.apiBaseUrl,r=Object(i.useContext)(x).setScToken,a=Object(i.useState)([]),c=Object(d.a)(a,2),o=c[0],s=c[1];return Object(i.useEffect)((function(){e&&fetch(t+"/api/rewards",{headers:{Authorization:"Bearer "+e}}).then(u).then((function(n){return s(n.data)})).catch((function(n){return h(r,n)}))}),[e,t,r]),[o]}(),l=Object(d.a)(b,1)[0];return Object(p.jsxs)(E,{children:[o&&Object(p.jsx)(y,{setUserConfig:s}),o&&Object(p.jsx)("div",{className:t.join(" "),children:Object(p.jsxs)("div",{className:"redemption",children:[Object(p.jsx)("img",{src:"/images/bttv.png",alt:"bttv"}),Object(p.jsxs)("label",{className:"switch",children:[Object(p.jsx)("input",{type:"checkbox",checked:o.Redemptions.Bttv.Active,onChange:function(n){var e=JSON.parse(JSON.stringify(o));e.Redemptions.Bttv.Active=n.target.checked,s(e)}}),Object(p.jsx)("span",{className:"slider round"})]}),Object(p.jsxs)("div",{className:"redemption-title",children:[Object(p.jsx)("span",{children:"Channel Points Reward Name"}),Object(p.jsx)("input",{type:"text",value:o.Redemptions.Bttv.Title,spellCheck:!1,onChange:function(n){var e=JSON.parse(JSON.stringify(o));e.Redemptions.Bttv.Title=n.target.value,s(e)}})]}),Object(p.jsxs)("span",{className:"hint",children:["make sure ",Object(p.jsx)("strong",{children:"gempbot"})," is bttv editor"]})]})}),Object(p.jsx)(U,{rewards:l})]})}var J,P,R,A,E=s.b.div(T||(T=Object(r.a)(['\n    margin-top: 5rem;\n    margin-left: 1rem;\n    margin-right: 1rem;\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    grid-gap: 2rem;\n\n    .userConfig {\n        padding-bottom: 2rem;\n        background: var(--bg);\n        transition: background-color ease-in-out 0.2s;\n\n        &.saved {\n            background: var(--theme);\n        }\n    }\n\n    .redemption {\n        display: flex;\n        align-items: center;\n        background: var(--bg-bright);\n        border: 1px solid var(--bg-brighter);\n        padding: 0.5rem;\n\n        img {\n            max-height: 3rem;\n            margin-left: 1rem;\n            margin-right: 2rem;\n        }\n\n        .redemption-title {\n            position: relative;\n\n            span {\n                position: absolute;\n                top: -13px;\n                left: 18px;\n                font-size: 11px;\n            }\n\n            input {\n                margin: 0;\n                padding: 0;\n                margin-left: 1rem;\n                font-size: 1rem;\n                background: var(--bg);\n                border: 1px solid var(--bg-bright);\n                padding: 5px;\n                color: white;\n\n                &:focus {\n                    outline: none;\n                    border: 1px solid var(--theme2);\n                }\n            }\n        }\n        \n        .hint {\n            margin-left: 1rem;\n\n            strong {\n                color: var(--theme-bright);\n            }\n        }\n    }\n\n    /* The switch - the box around the slider */\n    .switch {\n        position: relative;\n        display: inline-block;\n        width: 60px;\n        height: 34px;\n\n        input {\n            opacity: 0;\n            width: 0;\n            height: 0;\n        }\n    }\n    /* The slider */\n    .slider {\n        position: absolute;\n        cursor: pointer;\n        top: 0;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        background-color: #ccc;\n        -webkit-transition: .4s;\n        transition: .4s;\n\n        &:before {\n            position: absolute;\n            content: "";\n            height: 26px;\n            width: 26px;\n            left: 4px;\n            bottom: 4px;\n            background-color: white;\n            -webkit-transition: .4s;\n            transition: .4s;\n        }\n    }\n\n    input:checked + .slider {\n        background-color: var(--theme-bright);\n    }\n\n    input:focus + .slider {\n     box-shadow: 0 0 1px var(--theme-bright);\n    }\n\n    input:checked + .slider:before {\n        -webkit-transform: translateX(26px);\n        -ms-transform: translateX(26px);\n        transform: translateX(26px);\n    }\n\n    .slider.round {\n        border-radius: 34px;\n\n        &:before {\n            border-radius: 50%;\n        }\n    }\n']))),_=s.b.a(J||(J=Object(r.a)(["\n    position: absolute;\n    display: block;\n    color: white;\n    top: 1rem;\n    right: 1rem;\n    padding: 1rem 2rem;\n    text-decoration: none;\n    font-weight: bold;\n    border-radius: 3px;\n    background: var(--twitch);\n\n    &:hover {\n        background: var(--twitch-dark);\n    }\n"])));function I(){var n=Object(i.useContext)(x).state;return n.scToken?Object(p.jsx)(X,{}):Object(p.jsx)(_,{href:q(n.twitchClientId,n.apiBaseUrl).toString(),children:"Login"})}var L,F=s.b.div(P||(P=Object(r.a)(["\n    position: absolute;\n    top: 1rem;\n    right: 1rem;\n    display: flex;\n\n    a {\n        text-decoration: none;\n    }\n"]))),D=s.b.a(R||(R=Object(r.a)(["\n    display: block;\n    color: white;\n    width: 150px;\n    padding: 1rem 2rem;\n    text-decoration: none;\n    font-weight: bold;\n    border-radius: 3px;\n    background: var(--twitch);\n    cursor: pointer;\n\n    &:hover {\n        background: var(--twitch-dark);\n    }\n"]))),M=s.b.div(A||(A=Object(r.a)(["\n    display: block;\n    color: white;\n    margin-right: 1rem;\n    padding: 1rem 2rem;\n    text-decoration: none;\n    font-weight: bold;\n    border-radius: 3px;\n    background: var(--theme2-dark);\n    cursor: pointer;\n\n    &.dashboard {\n        background: var(--theme);\n\n        &:hover {\n        background: var(--theme-bright);\n    }\n    }\n\n    &:hover {\n        background: var(--theme2);\n    }\n"])));function X(){var n=Object(i.useContext)(x).state,e=Object(i.useState)("Logged In"),t=Object(d.a)(e,2),r=t[0],a=t[1];return Object(p.jsxs)(F,{children:[Object(p.jsx)(b.b,{to:"/",children:Object(p.jsx)(M,{children:"Home"})}),Object(p.jsx)(b.b,{to:"/dashboard",children:Object(p.jsx)(M,{className:"dashboard",children:"Dashboard"})}),Object(p.jsx)(D,{href:q(n.twitchClientId,n.apiBaseUrl).toString(),onMouseEnter:function(){return a("force login")},onMouseLeave:function(){return a("Logged In")},children:r})]})}function q(n,e){var t=new URL("https://id.twitch.tv/oauth2/authorize");return t.searchParams.set("client_id",n),t.searchParams.set("redirect_uri",e+"/api/callback"),t.searchParams.set("response_type","code"),t.searchParams.set("claims",JSON.stringify({userinfo:{picture:null,preferred_username:null}})),t.searchParams.set("scope","channel:read:redemptions channel:manage:redemptions"),t}var H,W,$=s.b.div(L||(L=Object(r.a)(["\n    display: inline-block;\n    background: var(--bg-bright);\n    border: 1px solid var(--bg-brighter);\n    padding: 0.5rem;\n    margin: 1rem;\n    margin-right: 0;\n    margin-bottom: 0;\n"])));function G(n){var e=n.activeChannels,t=n.joinedChannels;return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)($,{children:["Joined Channels: ",Object(p.jsx)("strong",{children:t})]}),Object(p.jsxs)($,{children:["Active Channels: ",Object(p.jsx)("strong",{children:e})]})]})}function K(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{src:"https://static-cdn.jtvnw.net/user-default-pictures-uv/cdd517fe-def4-11e9-948e-784f43822e80-profile_image-70x70.png"},e=n.src;return Object(p.jsx)("img",{src:e,width:"30",height:"30",alt:"profile"})}var Q=s.b.div(H||(H=Object(r.a)(["\n    display: flex;\n"])));function V(n){var e=n.records;return Object(p.jsx)(Q,{children:e.map((function(n){return Object(p.jsx)(Z,{record:n},n.title)}))})}var Y=s.b.div(W||(W=Object(r.a)(["\n    background: var(--bg-bright);\n    border: 1px solid var(--bg-brighter);\n    margin: 1rem;\n    margin-right: 0;\n    padding: 1rem;\n\n    h2 {\n        color: var(--text);\n        margin: 0;\n        margin-bottom: 1rem;\n        padding: 0;\n    }\n\n    ol {\n        color: white;\n        font-size: 1.5rem;\n        font-weight: bold;\n        width: 500px;\n        padding: 0;\n        margin: 0;\n        margin-right: 15px;\n        background: var(--lightBackground);\n        border: 1px solid var(--lightBorder);\n        border-radius: 3px;\n\n        li {\n            display: flex;\n            align-items: center;\n            margin-bottom: 0.25rem;\n\n            img {\n                margin-right: 10px;\n            }\n\n            .value {\n                text-align: right;\n                flex: 1 1 auto;\n            }\n        }\n    }\n"])));function Z(n){var e=n.record;return Object(p.jsxs)(Y,{children:[Object(p.jsx)("h2",{children:e.title}),Object(p.jsx)("ol",{children:e.scores.map((function(n){return Object(p.jsxs)("li",{children:[Object(p.jsx)(K,{src:n.user.profilePicture}),Object(p.jsx)("span",{children:n.user.displayName}),Object(p.jsx)("span",{className:"value",children:n.score})]},n.user.id)}))})]})}var nn,en,tn=t(25),rn=function n(e,t){Object(tn.a)(this,n),function n(){var r=new WebSocket("".concat(e.replace("https://","wss://").replace("http://","ws://"),"/api/ws"));r.onmessage=function(n){t(JSON.parse(n.data))},r.onclose=function(e){console.log("Socket is closed. Reconnect will be attempted in 1 second.",e.reason),setTimeout(n,1e3)},r.onerror=function(n){console.error("Socket encountered error: ",n,"Closing socket"),r.close()}}()},an=s.b.main(nn||(nn=Object(r.a)([""])));function cn(){var n=Object(i.useContext)(x).state,e=Object(i.useState)(0),t=Object(d.a)(e,2),r=t[0],a=t[1],c=Object(i.useState)(0),o=Object(d.a)(c,2),s=o[0],h=o[1],u=Object(i.useState)([]),g=Object(d.a)(u,2),j=g[0],m=g[1];return Object(i.useEffect)((function(){new rn(n.apiBaseUrl,(function(n){a(n.joinedChannels),h(n.activeChannels),m(n.records)}))}),[n.apiBaseUrl]),Object(p.jsx)(an,{children:Object(p.jsxs)(b.a,{children:[Object(p.jsx)(I,{}),Object(p.jsxs)(l.c,{children:[Object(p.jsx)(l.a,{path:"/dashboard",children:Object(p.jsx)(z,{})}),Object(p.jsxs)(l.a,{path:"/",children:[Object(p.jsx)(G,{activeChannels:s,joinedChannels:r}),Object(p.jsx)(V,{records:j})]})]})]})})}var on=Object(s.a)(en||(en=Object(r.a)(["\n    body {\n        --bg: #0e0e10;\n        --bg-bright: #18181b;\n        --bg-brighter: #3d4146;\n        --bg-dark: #121416;\n        --theme: #009148;\n        --theme-bright: #00a552;\n        --theme2: #2980b9;\n        --theme2-bright: #3498db;\n        --theme2-dark: #24618a;\n        --text: #F5F5F5;\n        --text-dark: #616161;\n        --twitch: #6441a5;\n        --twitch-dark: #4c317e;\n        --danger: #e74c3c;\n        --danger-dark: #c0392b;\n\n        background: var(--bg);\n        margin: 0;\n        padding: 0;\n        color: var(--text);\n        margin: 0;\n        font-family: Helvetica, Arial, sans-serif;\n        height: 100%;\n        width: 100%;\n\n        * {\n            box-sizing: border-box;\n        }\n    }\n"])));o.a.render(Object(p.jsx)(i.StrictMode,{children:Object(p.jsx)(v,{children:Object(p.jsxs)(a.a.Fragment,{children:[Object(p.jsx)(on,{}),Object(p.jsx)(cn,{})]})})}),document.getElementById("root"))}},[[37,1,2]]]);
//# sourceMappingURL=main.f4f8d7ad.chunk.js.map